import{u as P,f,s as j,p as w,q as D,g as U,c as u,o as i,a as e,K as R,i as k,k as d,l as q,e as c,d as p,I as g,t as x,F as T,x as G,n as b,j as y,G as B,h as H,v as N,z as K,L as J}from"./index-DBYf_VYy.js";const O={class:"min-h-screen bg-gray-100"},Q={class:"py-6"},W={class:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8"},X={class:"flex items-center mb-6"},Y={class:"bg-white shadow rounded-lg"},Z={class:"px-4 py-5 sm:p-6"},ee={class:"text-lg leading-6 font-medium text-gray-900"},te={class:"mt-4 border-b border-gray-200"},se={class:"-mb-px flex space-x-8","aria-label":"Tabs"},ae=["onClick"],re={class:"mt-4"},oe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},le={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ne={class:"mt-1 flex rounded-md shadow-sm",role:"group","aria-label":"Member status"},ie={key:0},de={class:"mt-1 flex items-center"},me={class:"text-2xl font-semibold text-amber-600"},ue={key:1},ce={key:2,class:"rounded-md bg-red-50 p-4"},be={class:"flex"},ve={class:"flex-shrink-0"},fe={class:"ml-3"},pe={class:"text-sm font-medium text-red-800"},ge={class:"mt-5 flex justify-end space-x-3"},xe=["disabled"],ye={key:0,class:"flex items-center justify-center"},he={key:1},we={class:"space-y-4"},ke={class:"flex items-center justify-between"},Ne={class:"text-3xl font-bold text-amber-600"},Te={__name:"MemberEdit",setup(_e){const _=q(),z=j(),l=D(),n=P(),r=f(z.params.id),v=f(!1),m=f(null),h=f("profile"),M=f(!1),F=[{name:"profile",label:"Profile",icon:"mdi:account"},{name:"activity",label:"Activity",icon:"mdi:history"}],$=w(()=>l.getters["transactions/allTransactions"]),A=w(()=>l.getters["transactions/isLoading"]),C=w(()=>l.getters["transactions/currentBalance"]),L=w(()=>l.getters["transactions/error"]),s=f({firstName:"",lastName:"",email:"",phoneNumber:"",membershipLevel:"bronze",status:"active",password:""}),S=async()=>{if(r.value)try{v.value=!0,await l.dispatch("members/fetchMemberDetails",r.value);const o=l.getters["members/currentMember"];if(!o){m.value="Failed to load member details",n("Failed to load member details","error");return}s.value={firstName:o.firstName||"",lastName:o.lastName||"",email:o.email||"",phoneNumber:o.phoneNumber||"",membershipLevel:o.membershipLevel||"bronze",status:o.status||"active"}}catch{m.value="Failed to load member details",n("Failed to load member details","error")}finally{v.value=!1}else s.value={firstName:"",lastName:"",email:"",phoneNumber:"",membershipLevel:"bronze",status:"active",points:0,password:""}},V=async()=>{try{v.value=!0,m.value=null,r.value?(await l.dispatch("members/updateMember",{id:r.value,data:s.value}),n("Member updated successfully","success")):(await l.dispatch("members/createMember",s.value),n("Member created successfully","success")),_.push("/admin/members")}catch(o){m.value=o.message||"An error occurred while saving the member.",n(m.value,"error")}finally{v.value=!1}},E=async o=>{try{await l.dispatch("transactions/createTransaction",{memberId:r.value,transactionData:o}),await Promise.all([l.dispatch("transactions/fetchBalance",r.value),l.dispatch("transactions/fetchTransactions",r.value)]),n("Transaction added successfully","success")}catch{n("Failed to add transaction","error")}},I=async()=>{if(r.value)try{await l.dispatch("transactions/fetchTransactions",r.value),await l.dispatch("transactions/fetchBalance",r.value)}catch{n("Failed to load transactions","error")}};return U(()=>{S(),I()}),(o,t)=>(i(),u(T,null,[e("div",O,[e("div",Q,[e("div",W,[e("div",X,[e("button",{type:"button",onClick:t[0]||(t[0]=a=>d(_).back()),class:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500"},[c(d(g),{icon:"mdi:arrow-left",class:"h-5 w-5 mr-2"}),t[11]||(t[11]=p(" Back to Members ",-1))])]),e("div",Y,[e("div",Z,[e("h3",ee,x(r.value?"Edit Member":"Add New Member"),1),e("div",te,[e("nav",se,[(i(),u(T,null,G(F,a=>e("button",{key:a.name,onClick:Me=>h.value=a.name,class:b([h.value===a.name?"border-amber-500 text-amber-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},[c(d(g),{icon:a.icon,class:"h-5 w-5 inline-block mr-2"},null,8,["icon"]),p(" "+x(a.label),1)],10,ae)),64))])]),e("div",re,[y(e("div",null,[e("form",{onSubmit:H(V,["prevent"]),class:"space-y-4"},[e("div",oe,[e("div",null,[t[12]||(t[12]=e("label",{for:"firstName",class:"block text-sm font-medium text-gray-700"},"First Name",-1)),y(e("input",{type:"text",id:"firstName","onUpdate:modelValue":t[1]||(t[1]=a=>s.value.firstName=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 sm:text-sm"},null,512),[[N,s.value.firstName]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"lastName",class:"block text-sm font-medium text-gray-700"},"Last Name",-1)),y(e("input",{type:"text",id:"lastName","onUpdate:modelValue":t[2]||(t[2]=a=>s.value.lastName=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 sm:text-sm"},null,512),[[N,s.value.lastName]])])]),e("div",null,[t[14]||(t[14]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1)),y(e("input",{type:"email",id:"email","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.email=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 sm:text-sm"},null,512),[[N,s.value.email]])]),e("div",le,[e("div",null,[t[18]||(t[18]=e("label",{for:"status",class:"block text-sm font-medium text-gray-700"},"Status",-1)),e("div",ne,[e("button",{type:"button",onClick:t[4]||(t[4]=a=>s.value.status="active"),class:b(["relative inline-flex items-center px-4 py-2 rounded-l-md border text-sm font-medium focus:z-10 focus:outline-none focus:ring-1 focus:ring-amber-500 focus:border-amber-500",s.value.status==="active"?"bg-amber-500 border-amber-500 text-white hover:bg-amber-600":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"])},[c(d(g),{icon:"mdi:check-circle",class:b(["h-4 w-4 mr-2",s.value.status==="active"?"text-white":"text-gray-400"])},null,8,["class"]),t[15]||(t[15]=p(" Active ",-1))],2),e("button",{type:"button",onClick:t[5]||(t[5]=a=>s.value.status="inactive"),class:b(["relative -ml-px inline-flex items-center px-4 py-2 border text-sm font-medium focus:z-10 focus:outline-none focus:ring-1 focus:ring-amber-500 focus:border-amber-500",s.value.status==="inactive"?"bg-amber-500 border-amber-500 text-white hover:bg-amber-600":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"])},[c(d(g),{icon:"mdi:pause-circle",class:b(["h-4 w-4 mr-2",s.value.status==="inactive"?"text-white":"text-gray-400"])},null,8,["class"]),t[16]||(t[16]=p(" Inactive ",-1))],2),e("button",{type:"button",onClick:t[6]||(t[6]=a=>s.value.status="suspended"),class:b(["relative -ml-px inline-flex items-center px-4 py-2 rounded-r-md border text-sm font-medium focus:z-10 focus:outline-none focus:ring-1 focus:ring-amber-500 focus:border-amber-500",s.value.status==="suspended"?"bg-amber-500 border-amber-500 text-white hover:bg-amber-600":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"])},[c(d(g),{icon:"mdi:block-helper",class:b(["h-4 w-4 mr-2",s.value.status==="suspended"?"text-white":"text-gray-400"])},null,8,["class"]),t[17]||(t[17]=p(" Suspended ",-1))],2)])])]),r.value?(i(),u("div",ie,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700"},"Points Balance",-1)),e("div",de,[e("span",me,x(C.value),1),t[19]||(t[19]=e("span",{class:"ml-2 text-sm text-gray-500"},"points",-1))])])):k("",!0),r.value?k("",!0):(i(),u("div",ue,[t[21]||(t[21]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Password",-1)),y(e("input",{type:"password",id:"password","onUpdate:modelValue":t[7]||(t[7]=a=>s.value.password=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring-amber-500 sm:text-sm"},null,512),[[N,s.value.password]])])),m.value?(i(),u("div",ce,[e("div",be,[e("div",ve,[c(d(g),{icon:"mdi:close-circle",class:"h-5 w-5 text-red-400","aria-hidden":"true"})]),e("div",fe,[e("h3",pe,x(m.value),1)])])])):k("",!0),e("div",ge,[e("button",{type:"button",class:"btn btn-secondary",onClick:t[8]||(t[8]=a=>d(_).back())}," Cancel "),e("button",{type:"submit",class:"btn btn-primary",disabled:v.value},[v.value?(i(),u("span",ye,[...t[22]||(t[22]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),p(" Saving... ",-1)])])):(i(),u("span",he,x(r.value?"Save Changes":"Create Member"),1))],8,xe)])],32)],512),[[B,h.value==="profile"]]),y(e("div",we,[e("div",ke,[e("div",null,[t[23]||(t[23]=e("h4",{class:"text-lg font-medium text-gray-900"},"Points Balance",-1)),e("p",Ne,x(C.value)+" points",1)])]),c(K,{transactions:$.value,loading:A.value,error:!!L.value,"show-add-button":!0,onAddTransaction:t[9]||(t[9]=a=>M.value=!0)},null,8,["transactions","loading","error"])],512),[[B,h.value==="activity"]])])])])])])]),r.value?(i(),R(J,{key:0,show:M.value,"member-id":r.value,onClose:t[10]||(t[10]=a=>M.value=!1),onTransactionAdded:E},null,8,["show","member-id"])):k("",!0)],64))}};export{Te as default};
