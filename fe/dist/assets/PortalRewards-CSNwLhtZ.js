import{m as P,u as $,f as x,p as C,q as S,g as D,c as i,o as a,s as L,i as v,a as t,e as m,k as d,I as u,l as V,d as g,t as l,F as q,x as z,w as F,y as M,z as U,n as R}from"./index-CRKFUS3C.js";const T={class:"min-h-screen bg-gray-50"},E={key:0,class:"flex items-center justify-center min-h-[50vh]"},Y={key:1,class:"flex items-center justify-center min-h-[50vh]"},G={class:"bg-white border-l-4 border-red-500 p-4 rounded-lg max-w-sm shadow-sm"},H={class:"flex items-center"},J={key:2,class:"max-w-7xl mx-auto px-4 py-6"},K={class:"mb-8 bg-gradient-to-r from-amber-50 via-amber-100 to-amber-50 rounded-2xl p-8 shadow-sm border border-amber-100"},O={class:"flex items-center gap-3 mb-2"},Q={class:"mt-3 text-gray-600 text-lg flex items-center gap-2"},W={class:"font-semibold text-2xl bg-gradient-to-r from-amber-600 to-amber-500 bg-clip-text text-transparent"},X={key:0,class:"space-y-6"},Z={class:"relative h-48 bg-gray-100 overflow-hidden"},tt=["src","alt"],et={key:1,class:"absolute inset-0 flex items-center justify-center bg-gradient-to-r from-amber-500 to-amber-600"},st={class:"absolute bottom-0 left-0 right-0 flex items-end justify-between p-6"},ot={class:"text-2xl font-bold text-white drop-shadow-lg"},nt={class:"bg-white/90 backdrop-blur-sm rounded-full px-4 py-2"},at={class:"text-lg font-bold text-amber-600"},it={class:"p-6"},lt={class:"mb-4"},rt={key:0,class:"text-sm text-gray-500"},dt={key:1},ct=["onClick"],mt={key:1,class:"text-sm text-gray-500"},ut=["onClick"],pt={class:"w-full"},xt=["onClick","disabled"],vt={key:0},gt={key:1},bt={key:2},ft={key:1,class:"text-center py-12 bg-white shadow rounded-xl"},yt={class:"space-y-4"},ht={key:0,class:"aspect-w-16 aspect-h-9 bg-gray-200 rounded-lg overflow-hidden"},_t=["src","alt"],kt={class:"text-gray-600"},wt={class:"border-t border-gray-200 pt-4"},Ct={class:"text-gray-600"},Rt={key:1,class:"border-t border-gray-200 pt-4"},jt={class:"text-sm text-gray-500"},At={class:"border-t border-gray-200 pt-4"},It={class:"flex items-center justify-between text-sm"},Bt={class:"font-medium text-gray-900"},Nt={class:"flex items-center justify-between text-sm mt-2"},Pt={class:"font-medium text-gray-900"},$t={class:"flex items-center justify-between text-sm mt-2"},Lt=P({__name:"PortalRewards",setup(St){const h=S(),j=V(),b=$(),p=x(!0),f=x(!1),y=x([]),o=x(null),c=C(()=>h.getters["auth/currentMembership"]),A=C(()=>h.getters.organization),_=async()=>{try{p.value=!0,f.value=!1;const n=await U.getRewards();y.value=n.rewards.map(e=>({...e,expanded:!1}))}catch{f.value=!0,b("Failed to load rewards","error")}finally{p.value=!1}},I=n=>{const e={"Birthday Reward":"mdi:cake","VIP Experience":"mdi:star","Mystery Brew":"mdi:flask","Loyalty Bonus":"mdi:heart",Achievement:"mdi:trophy"};if(e[n.name])return e[n.name];switch(n.type){case"product":return"mdi:gift";case"service":return"mdi:sparkles";case"discount":return"mdi:ticket";case"experience":return"mdi:star";default:return"mdi:gift"}},r=n=>{const e=c.value?.points??0;return n.isAvailable&&e>=n.pointsCost&&(!n.quantity||n.quantity>0)&&(!n.expiresAt||new Date(n.expiresAt)>new Date)},k=n=>{n.expanded=!n.expanded},B=n=>{o.value=n},N=async()=>{if(!(!o.value||!r(o.value)))try{b("Reward redeemed successfully!","success"),o.value=null,await _()}catch{b("Failed to redeem reward","error")}};return D(_),(n,e)=>(a(),i("div",T,[p.value?(a(),i("div",E,[...e[2]||(e[2]=[t("div",{class:"text-center"},[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600 mx-auto"}),t("p",{class:"mt-4 text-gray-500 animate-pulse"},"Loading rewards...")],-1)])])):f.value?(a(),i("div",Y,[t("div",G,[t("div",H,[m(d(u),{icon:"mdi:alert",class:"h-5 w-5 text-red-500 flex-shrink-0"}),e[3]||(e[3]=t("p",{class:"ml-3 text-sm text-gray-700"},"Unable to load rewards.",-1))])])])):(a(),i("div",J,[t("button",{onClick:e[0]||(e[0]=s=>d(j).push(`/members/${A.value?.slug}`)),class:"mb-6 inline-flex items-center text-gray-600 hover:text-gray-900"},[m(d(u),{icon:"mdi:arrow-left",class:"h-5 w-5 mr-1"}),e[4]||(e[4]=t("span",null,"Back",-1))]),t("div",K,[t("div",O,[m(d(u),{icon:"mdi:star",class:"h-8 w-8 text-amber-500"}),e[5]||(e[5]=t("h1",{class:"text-3xl font-bold bg-gradient-to-r from-amber-700 to-amber-500 bg-clip-text text-transparent"}," Available Rewards ",-1))]),t("p",Q,[e[6]||(e[6]=g(" You have ",-1)),t("span",W,l((c.value?.points??0).toLocaleString()),1),e[7]||(e[7]=g(" points available ",-1))])]),y.value.length>0?(a(),i("div",X,[(a(!0),i(q,null,z(y.value,s=>(a(),i("div",{key:s._id,class:"group bg-white overflow-hidden rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-200"},[t("div",Z,[s.base64Image?(a(),i("img",{key:0,src:s.base64Image,alt:s.name,class:"absolute inset-0 w-full h-full object-cover object-center"},null,8,tt)):(a(),i("div",et,[m(d(u),{icon:I(s),class:"h-16 w-16 text-white"},null,8,["icon"])])),e[8]||(e[8]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-black/50 via-transparent to-black/50"},null,-1)),t("div",st,[t("h3",ot,l(s.name),1),t("div",nt,[t("span",at,l(s.pointsCost.toLocaleString())+" pts",1)])])]),t("div",it,[t("div",lt,[s.description.length<=70?(a(),i("p",rt,l(s.description),1)):(a(),i("div",dt,[s.expanded?(a(),i("p",mt,[g(l(s.description)+" ",1),t("span",{class:"text-amber-600 font-medium ml-1 cursor-pointer hover:text-amber-700 transition-colors",onClick:w=>k(s)}," Show less ",8,ut)])):(a(),i("p",{key:0,class:"text-sm text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:w=>k(s)},[g(l(s.description.substring(0,70))+"... ",1),e[9]||(e[9]=t("span",{class:"text-amber-600 font-medium ml-1"},"Read more",-1))],8,ct))]))]),t("div",pt,[t("button",{onClick:w=>B(s),class:R(["w-full px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2",{"bg-black text-white hover:bg-gray-800 hover:scale-[1.02]":r(s),"bg-gray-100 text-gray-400 cursor-not-allowed":!r(s)}]),disabled:!r(s)},[m(d(u),{icon:r(s)?"mdi:gift":"mdi:lock",class:"h-5 w-5"},null,8,["icon"]),s.isAvailable?(c.value?.points??0)<s.pointsCost?(a(),i("span",gt," Need "+l(s.pointsCost-(c.value?.points??0))+" More Points ",1)):(a(),i("span",bt,"Redeem Now")):(a(),i("span",vt,"Currently Unavailable"))],10,xt)])])]))),128))])):p.value?v("",!0):(a(),i("div",ft,[m(d(u),{icon:"mdi:ticket",class:"mx-auto h-12 w-12 text-gray-400"}),e[10]||(e[10]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No rewards available",-1)),e[11]||(e[11]=t("p",{class:"mt-1 text-sm text-gray-500"},"Check back later for new rewards.",-1))]))])),o.value?(a(),L(M,{key:3,show:!!o.value,title:o.value.name,"confirm-text":"Redeem "+o.value.pointsCost+" Points","confirm-disabled":!r(o.value),onClose:e[1]||(e[1]=s=>o.value=null),onConfirm:N},{default:F(()=>[t("div",yt,[o.value.imageUrl?(a(),i("div",ht,[t("img",{src:o.value.imageUrl,alt:o.value.name,class:"object-cover"},null,8,_t)])):v("",!0),t("p",kt,l(o.value.description),1),t("div",wt,[e[12]||(e[12]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Redemption Instructions",-1)),t("p",Ct,l(o.value.redemptionInstructions||"Show this reward to staff to redeem."),1)]),o.value.termsAndConditions?(a(),i("div",Rt,[e[13]||(e[13]=t("h4",{class:"font-medium text-gray-900 mb-2"},"Terms & Conditions",-1)),t("p",jt,l(o.value.termsAndConditions),1)])):v("",!0),t("div",At,[t("div",It,[e[14]||(e[14]=t("span",{class:"text-gray-500"},"Your Points",-1)),t("span",Bt,l(c.value?.points??0),1)]),t("div",Nt,[e[15]||(e[15]=t("span",{class:"text-gray-500"},"Points Required",-1)),t("span",Pt,l(o.value.pointsCost),1)]),t("div",$t,[e[16]||(e[16]=t("span",{class:"text-gray-500"},"Remaining Points",-1)),t("span",{class:R(["font-medium",{"text-red-600":!r(o.value),"text-green-600":r(o.value)}])},l((c.value?.points??0)-o.value.pointsCost),3)])])])]),_:1},8,["show","title","confirm-text","confirm-disabled"])):v("",!0)]))}});export{Lt as default};
